<div class="admin-container">
  <!-- Migajas de Pan -->
  <nav class="breadcrumb-nav" aria-label="Migajas de pan">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="/dashboard" class="breadcrumb-link">INICIO</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        ENTREGAR CRÉDITOS
      </li>
    </ol>
  </nav>

  <!-- Encabezado -->
  <header class="admin-header">
    <h1 class="reset-title">MINISTRACIÓN DE CRÉDITOS</h1>
  </header>

  <!-- Contenido principal -->
  <div class="admin-content">
    <!-- Barra de búsqueda y filtros -->
    <div class="filtros-section">
      <div class="filtros-card">
        <h3>FILTRAR CLIENTES</h3>
        <div class="filtros-form">
          <div class="form-group">
            <label class="form-label">NOMBRE</label>
            <input type="text" class="form-control" placeholder="Buscar por nombre..." [(ngModel)]="filtroNombre">
          </div>
          <div class="form-group">
            <label class="form-label">APELLIDO PATERNO</label>
            <input type="text" class="form-control" placeholder="Buscar por apellido paterno..."
              [(ngModel)]="filtroApPaterno">
          </div>
          <div class="botones-filtros">
            <button class="btn btn-primary" (click)="buscar()">
              <i class="fas fa-search"></i> BUSCAR
            </button>
            <button class="btn btn-outline" (click)="limpiarFiltros()">
              <i class="fas fa-undo"></i> LIMPIAR
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pestañas de navegación -->
    <nav>
      <ul class="nav nav-tabs" id="creditosTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="solicitudes-tab" data-bs-toggle="tab" data-bs-target="#solicitudes"
            type="button" role="tab" aria-controls="solicitudes" aria-selected="true">
            <i class="fas fa-file-alt me-2"></i>SOLICITUDES APROBADAS
            <span class="badge bg-primary ms-2">{{solicitudesAprobadas.length}}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="pendientes-tab" data-bs-toggle="tab" data-bs-target="#pendientes" type="button"
            role="tab" aria-controls="pendientes" aria-selected="false">
            <i class="fas fa-clock me-2"></i>CRÉDITOS PENDIENTES
            <span class="badge bg-primary ms-2">{{getCreditosPorEstado('PENDIENTE').length}}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="entregados-tab" data-bs-toggle="tab" data-bs-target="#entregados" type="button"
            role="tab" aria-controls="entregados" aria-selected="false">
            <i class="fas fa-check-circle me-2"></i>CRÉDITOS ENTREGADOS
            <span class="badge bg-primary ms-2">{{getCreditosPorEstado('ENTREGADO').length}}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="devolucion-tab" data-bs-toggle="tab" data-bs-target="#devolucion" type="button"
            role="tab" aria-controls="devolucion" aria-selected="false">
            <i class="fas fa-redo me-2"></i>CRÉDITOS DEVOLUCIÓN
            <span class="badge bg-primary ms-2">{{getCreditosPorEstado('DEVOLUCION').length}}</span>
          </button>
        </li>
      </ul>
    </nav>

    <!-- Contenido de las pestañas -->
    <div class="tab-content pt-4" id="creditosTabContent">
      <!-- Pestaña 1: Solicitudes Aprobadas -->
      <div class="tab-pane fade show active" id="solicitudes" role="tabpanel" aria-labelledby="solicitudes-tab">
        <div class="tabla-section-vertical">
          <div class="tabla-header">
            <h3>SOLICITUDES APROBADAS PARA MINISTRACIÓN (ÚLTIMAS 6)</h3>
            <div class="botones-filtros">
              <button class="btn btn-outline btn-sm" (click)="cargarDatosIniciales()" [disabled]="cargando">
                <i class="fas fa-sync-alt" [class.fa-spin]="cargando"></i>
                {{ cargando ? 'Cargando...' : 'ACTUALIZAR' }}
              </button>
            </div>
          </div>

          <div class="table-container-vertical">
            <table class="table">
              <thead>
                <tr>
                  <th class="text-center">ID SOLICITUD</th>
                  <th class="text-center">ID CLIENTE</th>
                  <th>NOMBRE DEL CLIENTE</th>
                  <th>MONTO APROBADO</th>
                  <th>TASA DE INTERES</th>
                  <th>ALIADA</th>
                  <th class="text-center">FECHA DE APROBACIÓN</th>
                  <th class="actions-cell">ACCIÓN</th>
                </tr>
              </thead>
              <tbody>
                <!-- Estado de carga -->
                <tr *ngIf="cargando">
                  <td colspan="8" class="text-center">
                    <i class="fas fa-spinner fa-spin"></i> Cargando Datos...
                  </td>
                </tr>

                <!-- Sin solicitudes -->
                <tr *ngIf="!cargando && !haySolicitudes">
                  <td colspan="8" class="text-center">
                    No hay solicitudes aprobadas para ministración
                  </td>
                </tr>

                <!-- Lista de solicitudes aprobadas (máximo 6) -->
                <tr *ngFor="let solicitud of clientesFiltrados">
                  <td class="id_solicitud text-center">{{ solicitud.id_solicitud }}</td>
                  <td class="id_solicitud text-center">{{ solicitud.cliente_id || 'N/A' }}</td>
                  <td>{{ getNombreCompleto(solicitud) }}</td>
                  <td>{{ formatearMoneda(solicitud.monto_aprobado) }}</td>
                  <td>{{ solicitud.tasa_fija_formateada || (solicitud.tasa_fija ? ((solicitud.tasa_fija *
                    100).toFixed(0)) + '%' : '0%')}}</td>
                  <td>{{ solicitud.aliado_nombre || 'Sin asignar' }}</td>
                  <td class="text-center">{{ formatearFecha(solicitud.fecha_aprobacion) }}</td>
                  <td class="actions-cell">
                    <button class="btn btn-success btn-sm" (click)="abrirModalPagare(solicitud)">
                      <i class="fas fa-hand-holding-usd"></i> Pagaré
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>

            <!-- Contador de solicitudes -->
            <div class="mt-3 text-center">
              <span class="badge badge-info">
                Mostrando {{ clientesFiltrados.length }} de {{ solicitudesRecientes.length }} solicitudes recientes
              </span>
            </div>
          </div>

          <!-- Mensaje cuando no hay datos después de filtrar -->
          <div *ngIf="!cargando && haySolicitudes && clientesFiltrados.length === 0" class="no-data">
            <i class="fas fa-users fa-2x"></i>
            <p>No se encontraron clientes con los filtros aplicados</p>
          </div>
        </div>
      </div>

      <!-- Pestaña 2: Créditos Pendientes -->
      <!-- En la pestaña de CRÉDITOS PENDIENTES, actualiza la tabla: -->
      <div class="tab-pane fade" id="pendientes" role="tabpanel" aria-labelledby="pendientes-tab">
        <div class="table-container-vertical">
          <div class="tabla-header">
            <h3>CRÉDITOS PENDIENTES DE ENTREGA</h3>
            <div class="botones-filtros">
              <button class="btn btn-outline btn-sm" (click)="cargarCreditos()" [disabled]="cargandoCreditos">
                <i class="fas fa-sync-alt" [class.fa-spin]="cargandoCreditos"></i>
                {{ cargandoCreditos ? 'Cargando...' : 'Actualizar' }}
              </button>
            </div>
          </div>

          <div class="table-container-vertical">
            <table class="table">
              <thead>
                <tr>
                  <th class="text-center">ID CRÉDITO</th>
                  <th class="text-center">ID CLIENTE</th>
                  <th>NOMBRE COMPLETO</th>
                  <th class="text-center">MONTO TOTAL</th>
                  <th class="text-center">FECHA MINISTRACIÓN</th>
                  <th class="text-center">TIEMPO RESTANTE</th>
                  <th class="text-center">ACCIONES</th>
                </tr>
              </thead>
              <tbody>
                <!-- Estado de carga -->
                <tr *ngIf="cargandoCreditos">
                  <td colspan="7" class="text-center">
                    <i class="fas fa-spinner fa-spin"></i> Cargando créditos...
                  </td>
                </tr>

                <!-- Sin créditos pendientes -->
                <tr *ngIf="!cargandoCreditos && getCreditosPorEstado('PENDIENTE').length === 0">
                  <td colspan="7" class="text-center">
                    No hay créditos pendientes
                  </td>
                </tr>

                <!-- Lista de créditos pendientes -->
                <tr *ngFor="let credito of getCreditosPorEstado('PENDIENTE')"
                  [class.tiempo-critico]="getTiempoRestante(credito).esCritico"
                  [class.tiempo-advertencia]="getTiempoRestante(credito).esAdvertencia">
                  <td class="text-center fw-bold">{{ credito.id_credito }}</td>
                  <td class="text-center">
                    <span class="id_solicitud">{{ credito.cliente_id || 'N/A' }}</span>
                  </td>
                  <td>
                    <strong>{{ getNombreCompletoCredito(credito) }}</strong><br>
                    <small class="text-muted">
                      <i class="fas fa-id-card"></i> Solicitud: {{ credito.solicitud_id }}
                    </small>
                  </td>
                  <td class="text-center">
                    <span class="badge badge-primary">
                      {{ formatearMoneda(credito.total_a_pagar) }}
                    </span>
                  </td>
                  <td class="text-center">{{ formatearFecha(credito.fecha_ministracion) }}</td>
                  <td class="text-center">
                    <div class="temporizador-container" *ngIf="getTiempoRestante(credito).hayFecha">
                      <div class="temporizador" [ngClass]="{
                  'temporizador-normal': !getTiempoRestante(credito).esCritico && !getTiempoRestante(credito).esAdvertencia,
                  'temporizador-advertencia': getTiempoRestante(credito).esAdvertencia,
                  'temporizador-critico': getTiempoRestante(credito).esCritico
                }">
                        <i class="fas fa-clock"></i>
                        <span class="temporizador-texto">{{ getTiempoRestante(credito).texto }}</span>
                      </div>
                      <!-- <small class="text-muted d-block mt-1">
                  {{ getTiempoRestante(credito).porcentaje }}% transcurrido
                </small> -->
                      <div class="progress" style="height: 4px;">
                        <div class="progress-bar" [ngClass]="{
                         'bg-success': getTiempoRestante(credito).porcentaje < 50,
                         'bg-warning': getTiempoRestante(credito).porcentaje >= 50 && getTiempoRestante(credito).porcentaje < 75,
                         'bg-danger': getTiempoRestante(credito).porcentaje >= 75
                       }" [style.width.%]="getTiempoRestante(credito).porcentaje">
                        </div>
                      </div>
                    </div>
                    <span *ngIf="!getTiempoRestante(credito).hayFecha" class="text-muted">
                      Sin fecha de ministración
                    </span>
                  </td>
                  <td class="text-center">
                    <div class="btn-group-vertical btn-group-sm" role="group">
                      <button class="btn btn-success btn-sm mb-1" (click)="marcarComoEntregado(credito)">
                        <i class="fas fa-check-circle"></i> Entregar
                      </button>
                      <button class="btn btn-danger btn-sm" (click)="marcarComoDevolucion(credito)">
                        <i class="fas fa-undo"></i> Devolución
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Pestaña 3: Créditos Entregados -->
      <div class="tab-pane fade" id="entregados" role="tabpanel" aria-labelledby="entregados-tab">
        <div class="table-container-vertical">
          <div class="tabla-header">
            <h3>CRÉDITOS ENTREGADOS</h3>
            <div class="botones-filtros">
              <button class="btn btn-outline btn-sm" (click)="cargarCreditos()" [disabled]="cargandoCreditos">
                <i class="fas fa-sync-alt" [class.fa-spin]="cargandoCreditos"></i>
                {{ cargandoCreditos ? 'Cargando...' : 'Actualizar' }}
              </button>
            </div>
          </div>

          <div class="table-container-vertical">
            <table class="table">
              <thead>
                <tr>
                  <th class="text-center">ID CRÉDITO</th>
                  <th class="text-center">CLIENTE</th>
                  <th>NOMBRE COMPLETO</th>
                  <th class="text-center">MONTO TOTAL</th>
                  <!-- <th class="text-center">FECHA MINISTRACIÓN</th> -->
                  <th class="text-center">FECHA ENTREGA</th>
                  <th class="text-center">ALIADO</th>
                </tr>
              </thead>
              <tbody>
                <!-- Estado de carga -->
                <tr *ngIf="cargandoCreditos">
                  <td colspan="7" class="text-center">
                    <i class="fas fa-spinner fa-spin"></i> Cargando créditos...
                  </td>
                </tr>

                <!-- Sin créditos entregados -->
                <tr *ngIf="!cargandoCreditos && getCreditosPorEstado('ENTREGADO').length === 0">
                  <td colspan="7" class="text-center">
                    No hay créditos entregados
                  </td>
                </tr>

                <!-- Lista de créditos entregados -->
                <tr *ngFor="let credito of getCreditosPorEstado('ENTREGADO')">
                  <td class="text-center fw-bold">{{ credito.id_credito }}</td>
                  <td class="text-center">
                    <span class="id_solicitud">{{ credito.cliente_id || 'N/A' }}</span>
                  </td>
                  <td>
                    <strong>{{ getNombreCompletoCredito(credito) }}</strong><br>
                    <small class="text-muted">
                      <i class="fas fa-id-card"></i> Solicitud: {{ credito.solicitud_id }}
                    </small>
                  </td>
                  <td class="text-center">
                    <span class="badge badge-primary">
                      {{ formatearMoneda(credito.total_a_pagar) }}
                    </span>
                  </td>
                  <td class="text-center">{{ formatearFecha(credito.fecha_ministracion) }}</td>
                  <!-- <td class="text-center">{{ formatearFecha(credito.fecha_actualizacion) ||
                    formatearFecha(credito.fecha_entrega) || 'No registrada' }}</td> -->
                  <td class="text-center">
                    <span class="badge badge-secondary">{{ credito.nom_aliado || 'Sin aliado' }}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Pestaña 4: Créditos en Devolución -->
      <div class="tab-pane fade" id="devolucion" role="tabpanel" aria-labelledby="devolucion-tab">
        <div class="table-container-vertical">
          <div class="tabla-header">
            <h3>CRÉDITOS EN DEVOLUCIÓN</h3>
            <div class="botones-filtros">
              <button class="btn btn-outline btn-sm" (click)="cargarCreditos()" [disabled]="cargandoCreditos">
                <i class="fas fa-sync-alt" [class.fa-spin]="cargandoCreditos"></i>
                {{ cargandoCreditos ? 'Cargando...' : 'Actualizar' }}
              </button>
            </div>
          </div>

          <div class="table-container-vertical">
            <table class="table">
              <thead>
                <tr>
                  <th class="text-center">ID CRÉDITO</th>
                  <th class="text-center">CLIENTE</th>
                  <th>NOMBRE COMPLETO</th>
                  <th class="text-center">MONTO TOTAL</th>
                  <!-- <th class="text-center">FECHA MINISTRACIÓN</th> -->
                  <th class="text-center">ALIADO</th>
                  <th class="text-center">ACCIONES</th>
                </tr>
              </thead>
              <tbody>
                <!-- Estado de carga -->
                <tr *ngIf="cargandoCreditos">
                  <td colspan="7" class="text-center">
                    <i class="fas fa-spinner fa-spin"></i> Cargando créditos...
                  </td>
                </tr>

                <!-- Sin créditos en devolución -->
                <tr *ngIf="!cargandoCreditos && getCreditosPorEstado('DEVOLUCION').length === 0">
                  <td colspan="7" class="text-center">
                    No hay créditos en devolución
                  </td>
                </tr>

                <!-- Lista de créditos en devolución -->
                <tr *ngFor="let credito of getCreditosPorEstado('DEVOLUCION')">
                  <td class="text-center fw-bold">{{ credito.id_credito }}</td>
                  <td class="text-center">
                    <span class="id_solicitud">{{ credito.cliente_id || 'N/A' }}</span>
                  </td>
                  <td>
                    <strong>{{ getNombreCompletoCredito(credito) }}</strong><br>
                    <small class="text-muted">
                      <i class="fas fa-id-card"></i> Solicitud: {{ credito.solicitud_id }}
                    </small>
                  </td>
                  <td class="text-center">
                    <span class="badge badge-primary">
                      {{ formatearMoneda(credito.total_a_pagar) }}
                    </span>
                  </td>
                  <!-- <td class="text-center">{{ formatearFecha(credito.fecha_ministracion) }}</td> -->
                  <td class="text-center">
                    <span class="badge badge-secondary">{{ credito.nom_aliado || 'Sin aliado' }}</span>
                  </td>
                  <td class="text-center">
                    <button class="btn btn-success btn-sm" (click)="marcarComoPendiente(credito)">
                      <i class="fas fa-check-circle"></i> Re-entregar
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Modal para Generar Pagaré -->
<div class="modal-backdrop" *ngIf="modalPagareAbierto">
  <div class="modal-container modal-lg">
    <div class="modal-header">
      <h3>GENERAR PAGARÉ - {{ solicitudSeleccionada?.nombre_cliente }} {{ solicitudSeleccionada?.app_cliente }}</h3>
      <button class="btn-close" (click)="cerrarModalPagare()">&times;</button>
    </div>

    <div class="modal-body">
      <!-- Formulario de datos del crédito (si no se ha creado el crédito) -->
      <div *ngIf="!creditoRecienCreado">
        <div class="form-section">
          <h4>Completar Datos del Crédito</h4>
          <p class="text-muted">Complete los datos faltantes para crear el crédito y generar los documentos.</p>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label><strong>Fecha de Ministración *</strong></label>
                <input type="date" class="form-control" [(ngModel)]="fechaMinistracion" (change)="onValorCambiado()"
                  required>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label><strong>Fecha Primer Pago *</strong></label>
                <input type="date" class="form-control" [(ngModel)]="fechaPrimerPago" (change)="onValorCambiado()"
                  required>
              </div>
            </div>
          </div>

          <!-- <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label>Referencia Bancaria</label>
                <input type="text" class="form-control" [(ngModel)]="referenciaBancaria"
                  placeholder="Ingrese referencia bancaria">
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label>Cuenta Bancaria</label>
                <input type="text" class="form-control" [(ngModel)]="cuentaBancaria"
                  placeholder="Ingrese cuenta bancaria">
              </div>
            </div>
          </div> -->

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="seguro" (change)="onValorCambiado()">
              <strong>Incluir Seguro ($80.00)</strong>
            </label>
          </div>

          <!-- Información de la solicitud (solo lectura) -->
          <div class="info-solicitud">
            <h5>Información de la Solicitud</h5>
            <div class="row">
              <div class="col-md-6">
                <p><strong>Cliente:</strong> {{ getNombreCompleto(solicitudSeleccionada) }}</p>
                <p><strong>Monto Aprobado:</strong> {{ formatearMoneda(solicitudSeleccionada?.monto_aprobado) }}</p>
                <p><strong>Aliado:</strong> {{ solicitudSeleccionada?.aliado_nombre }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Tasa de Interés:</strong> {{ solicitudSeleccionada?.tasa_fija_formateada || '0%' }}</p>
                <p><strong>Tipo de Crédito:</strong> {{ solicitudSeleccionada?.tipo_credito }}</p>
                <p><strong>ID Solicitud:</strong> {{ solicitudSeleccionada?.id_solicitud }}</p>
              </div>
            </div>
          </div>

          <!-- Resumen del crédito -->
          <div class="resumen-credito">
            <h5>Resumen del Crédito</h5>
            <table class="table table-sm table-bordered">
              <tr>
                <td class="resumen-credito">Capital:</td>
                <td class="text-right">{{ formatearMoneda(totalCapital) }}</td>
              </tr>
              <tr>
                <!-- <td>Interés ({{ solicitudSeleccionada?.tasa_fija || 0 }}%):</td> -->
                <td>{{ solicitudSeleccionada.tasa_fija_formateada || (solicitudSeleccionada.tasa_fija ?
                  ((solicitudSeleccionada.tasa_fija * 100).toFixed(0)) + '%' : '0%')}}</td>
                <td class="text-right">{{ formatearMoneda(totalInteres) }}</td>
              </tr>
              <tr *ngIf="seguro">
                <td>Seguro:</td>
                <td class="text-right">{{ formatearMoneda(totalSeguro) }}</td>
              </tr>
              <tr>
                <td>Garantía (10%):</td>
                <td class="text-right">{{ formatearMoneda(totalGarantia) }}</td>
              </tr>
              <tr class="total-row">
                <td>TOTAL A PAGAR:</td>
                <td class="text-right">{{ formatearMoneda(totalAPagar) }}</td>
              </tr>
              <tr>
                <td>Pago Semanal (16 semanas):</td>
                <td class="text-right">{{ formatearMoneda(pagoSemanal) }}</td>
              </tr>
            </table>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="cerrarModalPagare()">Cancelar</button>
          <button class="btn btn-primary" (click)="crearCredito()"
            [disabled]="!fechaMinistracion || !fechaPrimerPago || procesandoEntrega">
            <i class="fas fa-save" *ngIf="!procesandoEntrega"></i>
            <i class="fas fa-spinner fa-spin" *ngIf="procesandoEntrega"></i>
            {{ procesandoEntrega ? 'Creando Crédito...' : 'Crear Crédito' }}
          </button>
        </div>
      </div>

      <!-- Vista de documentos (después de crear el crédito) -->
      <div *ngIf="creditoRecienCreado">
        <div class="alert alert-success">
          <i class="fas fa-check-circle"></i>
          <strong>Crédito creado exitosamente!</strong> ID: {{ creditoRecienCreado.id_credito }}
        </div>

        <div class="documentos-tabs">
          <button class="tab-btn" [class.active]="documentoActual === 'pagare'" (click)="cambiarDocumento('pagare')">
            <i class="fas fa-file-contract"></i> Pagaré
          </button>
          <button class="tab-btn" [class.active]="documentoActual === 'hojaControl'"
            (click)="cambiarDocumento('hojaControl')">
            <i class="fas fa-clipboard-list"></i> Hoja de Control
          </button>
        </div>

        <div class="documento-viewer">
          <!-- Cargando -->
          <div *ngIf="documentoCargando" class="loading-doc">
            <i class="fas fa-spinner fa-spin fa-2x"></i>
            <p>Generando documento...</p>
          </div>

          <!-- Vista previa del pagaré -->
          <div *ngIf="documentoActual === 'pagare' && pdfPagareUrl && !documentoCargando">
            <iframe [src]="pdfPagareUrl" width="800px" height="800px"></iframe>
            <div class="documento-actions">
              <button class="btn btn-success" (click)="descargarPagare()">
                <i class="fas fa-download"></i> Descargar Pagaré
              </button>
            </div>
          </div>

          <!-- Vista previa de la hoja de control -->
          <div *ngIf="documentoActual === 'hojaControl' && pdfHojaControlUrl && !documentoCargando">
            <iframe [src]="pdfHojaControlUrl" width="800px" height="800px"></iframe>
            <div class="documento-actions">
              <button class="btn btn-success" (click)="descargarHojaControl()">
                <i class="fas fa-download"></i> Descargar Hoja de Control
              </button>
            </div>
          </div>

          <!-- Mensaje si no se ha generado documento -->
          <div *ngIf="!pdfPagareUrl && documentoActual === 'pagare' && !documentoCargando" class="generate-prompt">
            <i class="fas fa-file-pdf fa-3x mb-3"></i>
            <h5>Generar Pagaré</h5>
            <p>Haga clic en el botón para generar el pagaré</p>
            <button class="btn btn-primary" (click)="generarVistaPreviaPagare()">
              <i class="fas fa-file-pdf"></i> Generar Pagaré
            </button>
          </div>

          <div *ngIf="!pdfHojaControlUrl && documentoActual === 'hojaControl' && !documentoCargando"
            class="generate-prompt">
            <i class="fas fa-file-alt fa-3x mb-3"></i>
            <h5>Generar Hoja de Control</h5>
            <p>Haga clic en el botón para generar la hoja de control</p>
            <button class="btn btn-primary" (click)="generarVistaPreviaHojaControl()">
              <i class="fas fa-file-alt"></i> Generar Hoja de Control
            </button>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="cerrarModalPagare()">Cerrar</button>
          <button class="btn btn-success" (click)="descargarAmbosDocumentos()" *ngIf="documentosGenerados">
            <i class="fas fa-download"></i> Descargar Ambos Documentos
          </button>
        </div>
      </div>
    </div>
  </div>
</div>